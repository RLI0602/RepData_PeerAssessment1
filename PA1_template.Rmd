---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data
1. Load the Data
```
activity <- read.csv(file = "C:/Users/rli/Documents/activity.csv")
```
2 Process the data into a format suitable for the analysis
```
library(reshape2)
actMeltDate <- melt(activity, id.vars="date", measure.vars="steps", na.rm=FALSE)
actCastDate <- dcast(actMeltDate, date ~ variable, sum)
```


## What is mean total number of steps taken per day?
1. Calculate the total number of steps taken per day
```
total.steps <- tapply(activity$steps, activity$date, FUN=sum, na.rm=TRUE)
```
2. Make a histogram of the total number of steps taken each day
```
plot(actCastDate$date, actCastDate$steps, type="h", main="Histogram of Daily Steps", xlab="Date", ylab="Steps per Day", col="blue", lwd=8)
abline(h=mean(actCastDate$steps, na.rm=TRUE), col="red", lwd=2)
```
3. Calculate and report the mean and median of the total number of steps taken per day
```
mean(total.steps, na.rm=TRUE)
median(total.steps, na.rm=TRUE)
```



## What is the average daily activity pattern?
1. Make a time series plot of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis)
```
library(ggplot2)
averages <- aggregate(x=list(steps=activity$steps),by=list(interval=activity$interval),FUN=mean, na.rm=TRUE)
ggplot(data=averages,aes(x=interval, y=steps)) + 
geom_line()+
xlab("5-minute interval") +
ylab("average number of steps taken")
```
2. Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps
```
averages[which.max(averages$steps),]
```



## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
